..\code\tiled_forward.frag
// Module Version 10000
// Generated by (magic number): 80006
// Id's are bound by 219

                              Capability Shader
               1:             ExtInstImport  "GLSL.std.450"
                              MemoryModel Logical GLSL450
                              EntryPoint Fragment 4  "main" 17 24 32 123 210
                              ExecutionMode 4 OriginUpperLeft
                              Source GLSL 450
                              SourceExtension  "GL_ARB_separate_shader_objects"
                              SourceExtension  "GL_ARB_shading_language_420pack"
                              Name 4  "main"
                              Name 9  "Diffuse"
                              Name 13  "DiffuseSampler"
                              Name 17  "InTexCoord"
                              Name 22  "Normal"
                              Name 24  "InWorldNormal"
                              Name 30  "PixelPos"
                              Name 32  "gl_FragCoord"
                              Name 36  "TilePos"
                              Name 42  "TileId"
                              Name 46  "frag_constants"
                              MemberName 46(frag_constants) 0  "SpecularIntensity"
                              MemberName 46(frag_constants) 1  "SpecularPower"
                              MemberName 46(frag_constants) 2  "ScreenX"
                              MemberName 46(frag_constants) 3  "ScreenY"
                              MemberName 46(frag_constants) 4  "NumTilesX"
                              MemberName 46(frag_constants) 5  "MaxLightsPerTile"
                              Name 48  "Const"
                              Name 59  "BufferPtr"
                              Name 65  "EyeWorldPos"
                              Name 68  "NumLightsInTile"
                              Name 70  "point_light_index_buffer"
                              MemberName 70(point_light_index_buffer) 0  "PointLightIndexArray"
                              Name 72  ""
                              Name 78  "MixedColor"
                              Name 79  "LightIndexId"
                              Name 90  "LightId"
                              Name 96  "point_light"
                              MemberName 96(point_light) 0  "Pos"
                              MemberName 96(point_light) 1  "Radius"
                              MemberName 96(point_light) 2  "Color"
                              MemberName 96(point_light) 3  "AmbientIntensity"
                              MemberName 96(point_light) 4  "DiffuseIntensity"
                              Name 98  "CurrLight"
                              Name 99  "point_light"
                              MemberName 99(point_light) 0  "Pos"
                              MemberName 99(point_light) 1  "Radius"
                              MemberName 99(point_light) 2  "Color"
                              MemberName 99(point_light) 3  "AmbientIntensity"
                              MemberName 99(point_light) 4  "DiffuseIntensity"
                              Name 101  "point_light_array"
                              MemberName 101(point_light_array) 0  "PointLightArray"
                              Name 103  ""
                              Name 122  "LightToWorld"
                              Name 123  "InWorldPos"
                              Name 128  "LightDist"
                              Name 131  "Attenuation"
                              Name 138  "TestZ"
                              Name 144  "WorldToEye"
                              Name 149  "LightReflectionDir"
                              Name 154  "DiffuseFactor"
                              Name 159  "SpecularFactor"
                              Name 168  "AmbientColor"
                              Name 177  "DiffuseColor"
                              Name 188  "SpecularColor"
                              Name 210  "OutColor"
                              Name 218  "DebugHeatMap"
                              Decorate 13(DiffuseSampler) DescriptorSet 0
                              Decorate 13(DiffuseSampler) Binding 0
                              Decorate 17(InTexCoord) Location 1
                              Decorate 24(InWorldNormal) Location 2
                              Decorate 32(gl_FragCoord) BuiltIn FragCoord
                              MemberDecorate 46(frag_constants) 0 Offset 128
                              MemberDecorate 46(frag_constants) 1 Offset 132
                              MemberDecorate 46(frag_constants) 2 Offset 136
                              MemberDecorate 46(frag_constants) 3 Offset 140
                              MemberDecorate 46(frag_constants) 4 Offset 144
                              MemberDecorate 46(frag_constants) 5 Offset 148
                              Decorate 46(frag_constants) Block
                              Decorate 69 ArrayStride 4
                              MemberDecorate 70(point_light_index_buffer) 0 NonWritable
                              MemberDecorate 70(point_light_index_buffer) 0 Offset 0
                              Decorate 70(point_light_index_buffer) BufferBlock
                              Decorate 72 DescriptorSet 1
                              Decorate 72 Binding 1
                              MemberDecorate 99(point_light) 0 Offset 0
                              MemberDecorate 99(point_light) 1 Offset 12
                              MemberDecorate 99(point_light) 2 Offset 16
                              MemberDecorate 99(point_light) 3 Offset 28
                              MemberDecorate 99(point_light) 4 Offset 32
                              Decorate 100 ArrayStride 48
                              MemberDecorate 101(point_light_array) 0 NonWritable
                              MemberDecorate 101(point_light_array) 0 Offset 0
                              Decorate 101(point_light_array) BufferBlock
                              Decorate 103 DescriptorSet 1
                              Decorate 103 Binding 0
                              Decorate 123(InWorldPos) Location 0
                              Decorate 210(OutColor) Location 0
                              Decorate 218(DebugHeatMap) DescriptorSet 1
                              Decorate 218(DebugHeatMap) Binding 2
               2:             TypeVoid
               3:             TypeFunction 2
               6:             TypeFloat 32
               7:             TypeVector 6(float) 4
               8:             TypePointer Function 7(fvec4)
              10:             TypeImage 6(float) 2D sampled format:Unknown
              11:             TypeSampledImage 10
              12:             TypePointer UniformConstant 11
13(DiffuseSampler):     12(ptr) Variable UniformConstant
              15:             TypeVector 6(float) 2
              16:             TypePointer Input 15(fvec2)
  17(InTexCoord):     16(ptr) Variable Input
              20:             TypeVector 6(float) 3
              21:             TypePointer Function 20(fvec3)
              23:             TypePointer Input 20(fvec3)
24(InWorldNormal):     23(ptr) Variable Input
              27:             TypeInt 32 0
              28:             TypeVector 27(int) 2
              29:             TypePointer Function 28(ivec2)
              31:             TypePointer Input 7(fvec4)
32(gl_FragCoord):     31(ptr) Variable Input
              38:     27(int) Constant 4
              39:   28(ivec2) ConstantComposite 38 38
              41:             TypePointer Function 27(int)
              43:     27(int) Constant 1
46(frag_constants):             TypeStruct 6(float) 6(float) 27(int) 27(int) 27(int) 27(int)
              47:             TypePointer PushConstant 46(frag_constants)
       48(Const):     47(ptr) Variable PushConstant
              49:             TypeInt 32 1
              50:     49(int) Constant 4
              51:             TypePointer PushConstant 27(int)
              55:     27(int) Constant 0
              61:     49(int) Constant 5
              66:    6(float) Constant 0
              67:   20(fvec3) ConstantComposite 66 66 66
              69:             TypeRuntimeArray 27(int)
70(point_light_index_buffer):             TypeStruct 69
              71:             TypePointer Uniform 70(point_light_index_buffer)
              72:     71(ptr) Variable Uniform
              73:     49(int) Constant 0
              75:             TypePointer Uniform 27(int)
              88:             TypeBool
 96(point_light):             TypeStruct 20(fvec3) 6(float) 20(fvec3) 6(float) 6(float)
              97:             TypePointer Function 96(point_light)
 99(point_light):             TypeStruct 20(fvec3) 6(float) 20(fvec3) 6(float) 6(float)
             100:             TypeRuntimeArray 99(point_light)
101(point_light_array):             TypeStruct 100
             102:             TypePointer Uniform 101(point_light_array)
             103:    102(ptr) Variable Uniform
             105:             TypePointer Uniform 99(point_light)
             111:     49(int) Constant 1
             112:             TypePointer Function 6(float)
             115:     49(int) Constant 2
             118:     49(int) Constant 3
 123(InWorldPos):     23(ptr) Variable Input
             132:    6(float) Constant 1065353216
             164:             TypePointer PushConstant 6(float)
             209:             TypePointer Output 7(fvec4)
   210(OutColor):    209(ptr) Variable Output
             216:             TypeImage 49(int) 2D nonsampled format:R32i
             217:             TypePointer UniformConstant 216
218(DebugHeatMap):    217(ptr) Variable UniformConstant
         4(main):           2 Function None 3
               5:             Label
      9(Diffuse):      8(ptr) Variable Function
      22(Normal):     21(ptr) Variable Function
    30(PixelPos):     29(ptr) Variable Function
     36(TilePos):     29(ptr) Variable Function
      42(TileId):     41(ptr) Variable Function
   59(BufferPtr):     41(ptr) Variable Function
 65(EyeWorldPos):     21(ptr) Variable Function
68(NumLightsInTile):     41(ptr) Variable Function
  78(MixedColor):     21(ptr) Variable Function
79(LightIndexId):     41(ptr) Variable Function
     90(LightId):     41(ptr) Variable Function
   98(CurrLight):     97(ptr) Variable Function
122(LightToWorld):     21(ptr) Variable Function
  128(LightDist):    112(ptr) Variable Function
131(Attenuation):    112(ptr) Variable Function
      138(TestZ):    112(ptr) Variable Function
 144(WorldToEye):     21(ptr) Variable Function
149(LightReflectionDir):     21(ptr) Variable Function
154(DiffuseFactor):    112(ptr) Variable Function
159(SpecularFactor):    112(ptr) Variable Function
168(AmbientColor):     21(ptr) Variable Function
177(DiffuseColor):     21(ptr) Variable Function
188(SpecularColor):     21(ptr) Variable Function
              14:          11 Load 13(DiffuseSampler)
              18:   15(fvec2) Load 17(InTexCoord)
              19:    7(fvec4) ImageSampleImplicitLod 14 18
                              Store 9(Diffuse) 19
              25:   20(fvec3) Load 24(InWorldNormal)
              26:   20(fvec3) ExtInst 1(GLSL.std.450) 69(Normalize) 25
                              Store 22(Normal) 26
              33:    7(fvec4) Load 32(gl_FragCoord)
              34:   15(fvec2) VectorShuffle 33 33 0 1
              35:   28(ivec2) ConvertFToU 34
                              Store 30(PixelPos) 35
              37:   28(ivec2) Load 30(PixelPos)
              40:   28(ivec2) UDiv 37 39
                              Store 36(TilePos) 40
              44:     41(ptr) AccessChain 36(TilePos) 43
              45:     27(int) Load 44
              52:     51(ptr) AccessChain 48(Const) 50
              53:     27(int) Load 52
              54:     27(int) IMul 45 53
              56:     41(ptr) AccessChain 36(TilePos) 55
              57:     27(int) Load 56
              58:     27(int) IAdd 54 57
                              Store 42(TileId) 58
              60:     27(int) Load 42(TileId)
              62:     51(ptr) AccessChain 48(Const) 61
              63:     27(int) Load 62
              64:     27(int) IMul 60 63
                              Store 59(BufferPtr) 64
                              Store 65(EyeWorldPos) 67
              74:     27(int) Load 59(BufferPtr)
              76:     75(ptr) AccessChain 72 73 74
              77:     27(int) Load 76
                              Store 68(NumLightsInTile) 77
                              Store 78(MixedColor) 67
                              Store 79(LightIndexId) 43
                              Branch 80
              80:             Label
                              LoopMerge 82 83 None
                              Branch 84
              84:             Label
              85:     27(int) Load 79(LightIndexId)
              86:     27(int) Load 68(NumLightsInTile)
              87:     27(int) IAdd 86 43
              89:    88(bool) ULessThan 85 87
                              BranchConditional 89 81 82
              81:               Label
              91:     27(int)   Load 59(BufferPtr)
              92:     27(int)   Load 79(LightIndexId)
              93:     27(int)   IAdd 91 92
              94:     75(ptr)   AccessChain 72 73 93
              95:     27(int)   Load 94
                                Store 90(LightId) 95
             104:     27(int)   Load 90(LightId)
             106:    105(ptr)   AccessChain 103 73 104
             107:99(point_light)   Load 106
             108:   20(fvec3)   CompositeExtract 107 0
             109:     21(ptr)   AccessChain 98(CurrLight) 73
                                Store 109 108
             110:    6(float)   CompositeExtract 107 1
             113:    112(ptr)   AccessChain 98(CurrLight) 111
                                Store 113 110
             114:   20(fvec3)   CompositeExtract 107 2
             116:     21(ptr)   AccessChain 98(CurrLight) 115
                                Store 116 114
             117:    6(float)   CompositeExtract 107 3
             119:    112(ptr)   AccessChain 98(CurrLight) 118
                                Store 119 117
             120:    6(float)   CompositeExtract 107 4
             121:    112(ptr)   AccessChain 98(CurrLight) 50
                                Store 121 120
             124:   20(fvec3)   Load 123(InWorldPos)
             125:     21(ptr)   AccessChain 98(CurrLight) 73
             126:   20(fvec3)   Load 125
             127:   20(fvec3)   FSub 124 126
                                Store 122(LightToWorld) 127
             129:   20(fvec3)   Load 122(LightToWorld)
             130:    6(float)   ExtInst 1(GLSL.std.450) 66(Length) 129
                                Store 128(LightDist) 130
             133:    6(float)   Load 128(LightDist)
             134:    112(ptr)   AccessChain 98(CurrLight) 111
             135:    6(float)   Load 134
             136:    6(float)   FDiv 133 135
             137:    6(float)   FSub 132 136
                                Store 131(Attenuation) 137
             139:    112(ptr)   AccessChain 98(CurrLight) 111
             140:    6(float)   Load 139
             141:    6(float)   Load 128(LightDist)
             142:    6(float)   FSub 140 141
             143:    6(float)   ExtInst 1(GLSL.std.450) 48(Step) 66 142
                                Store 138(TestZ) 143
             145:   20(fvec3)   Load 65(EyeWorldPos)
             146:   20(fvec3)   Load 123(InWorldPos)
             147:   20(fvec3)   FSub 145 146
             148:   20(fvec3)   ExtInst 1(GLSL.std.450) 69(Normalize) 147
                                Store 144(WorldToEye) 148
             150:   20(fvec3)   Load 122(LightToWorld)
             151:   20(fvec3)   Load 22(Normal)
             152:   20(fvec3)   ExtInst 1(GLSL.std.450) 71(Reflect) 150 151
             153:   20(fvec3)   ExtInst 1(GLSL.std.450) 69(Normalize) 152
                                Store 149(LightReflectionDir) 153
             155:   20(fvec3)   Load 22(Normal)
             156:   20(fvec3)   Load 122(LightToWorld)
             157:   20(fvec3)   FNegate 156
             158:    6(float)   Dot 155 157
                                Store 154(DiffuseFactor) 158
             160:   20(fvec3)   Load 144(WorldToEye)
             161:   20(fvec3)   Load 149(LightReflectionDir)
             162:    6(float)   Dot 160 161
             163:    6(float)   ExtInst 1(GLSL.std.450) 40(FMax) 66 162
             165:    164(ptr)   AccessChain 48(Const) 111
             166:    6(float)   Load 165
             167:    6(float)   ExtInst 1(GLSL.std.450) 26(Pow) 163 166
                                Store 159(SpecularFactor) 167
             169:    112(ptr)   AccessChain 98(CurrLight) 118
             170:    6(float)   Load 169
             171:     21(ptr)   AccessChain 98(CurrLight) 115
             172:   20(fvec3)   Load 171
             173:   20(fvec3)   VectorTimesScalar 172 170
             174:    7(fvec4)   Load 9(Diffuse)
             175:   20(fvec3)   VectorShuffle 174 174 0 1 2
             176:   20(fvec3)   FMul 173 175
                                Store 168(AmbientColor) 176
             178:    6(float)   Load 154(DiffuseFactor)
             179:    112(ptr)   AccessChain 98(CurrLight) 50
             180:    6(float)   Load 179
             181:    6(float)   FMul 178 180
             182:     21(ptr)   AccessChain 98(CurrLight) 115
             183:   20(fvec3)   Load 182
             184:   20(fvec3)   VectorTimesScalar 183 181
             185:    7(fvec4)   Load 9(Diffuse)
             186:   20(fvec3)   VectorShuffle 185 185 0 1 2
             187:   20(fvec3)   FMul 184 186
                                Store 177(DiffuseColor) 187
             189:    6(float)   Load 159(SpecularFactor)
             190:    164(ptr)   AccessChain 48(Const) 73
             191:    6(float)   Load 190
             192:    6(float)   FMul 189 191
             193:     21(ptr)   AccessChain 98(CurrLight) 115
             194:   20(fvec3)   Load 193
             195:   20(fvec3)   VectorTimesScalar 194 192
                                Store 188(SpecularColor) 195
             196:    6(float)   Load 138(TestZ)
             197:    6(float)   Load 131(Attenuation)
             198:    6(float)   FMul 196 197
             199:   20(fvec3)   Load 168(AmbientColor)
             200:   20(fvec3)   Load 177(DiffuseColor)
             201:   20(fvec3)   FAdd 199 200
             202:   20(fvec3)   Load 188(SpecularColor)
             203:   20(fvec3)   FAdd 201 202
             204:   20(fvec3)   VectorTimesScalar 203 198
             205:   20(fvec3)   Load 78(MixedColor)
             206:   20(fvec3)   FAdd 205 204
                                Store 78(MixedColor) 206
                                Branch 83
              83:               Label
             207:     27(int)   Load 79(LightIndexId)
             208:     27(int)   IAdd 207 111
                                Store 79(LightIndexId) 208
                                Branch 80
              82:             Label
             211:   20(fvec3) Load 78(MixedColor)
             212:    6(float) CompositeExtract 211 0
             213:    6(float) CompositeExtract 211 1
             214:    6(float) CompositeExtract 211 2
             215:    7(fvec4) CompositeConstruct 212 213 214 132
                              Store 210(OutColor) 215
                              Return
                              FunctionEnd
